dev
§/afarah18/spectral-sirens-with-GPs
Draft version August 26, 2024
Typeset using LATEX preprint2 style in AASTeX631
No need to know: towards astrophysics-free gravitational-wave cosmology
Amanda M. Farah ,
1 Thomas A. Callister ,
2 Jose Mar´ıa Ezquiaga ,
3 Michael Zevin ,
4
and Daniel E. Holz 1, 2, 5, 6
1Department of Physics, University of Chicago, Chicago, IL 60637, USA
2Kavli Institute for Cosmological Physics, The University of Chicago, Chicago, IL 60637, USA
3Niels Bohr International Academy, Niels Bohr Institute, Blegdamsvej 17, DK-2100 Copenhagen, Denmark
4The Adler Planetarium, 1300 South DuSable Lake Shore Drive, Chicago, 60605, IL, USA
5Department of Astronomy & Astrophysics, The University of Chicago, Chicago, IL 60637, USA
6Enrico Fermi Institute, The University of Chicago, Chicago, IL 60637, USA
ABSTRACT
Gravitational waves (GWs) from merging compact objects encode direct information
about the luminosity distance to the binary. When paired with a redshift measurement, this enables standard-siren cosmology: a Hubble diagram can be constructed to
directly probe the Universe’s expansion. This can be done in the absence of electromagnetic measurements, as features in the mass distribution of GW sources provide
self-calibrating redshift measurements without the need for a definite or probabilistic
host galaxy association. This “spectral siren” technique has thus far only been applied
with simple parametric representations of the mass distribution, and theoretical predictions for features in the mass distribution are commonly presumed to be fundamental
to the measurement. However, the use of an inaccurate representation leads to biases
in the cosmological inference, an acute problem given the current uncertainties in true
source population. Furthermore, it is commonly presumed that the form of the mass
distribution must be known a priori to obtain unbiased measurements of cosmological
parameters in this fashion. Here, we demonstrate that spectral sirens can accurately
infer cosmological parameters without such prior assumptions. We apply a flexible, nonparametric model for the mass distribution of compact binaries to a simulated catalog
of 1,000 GW signals, consistent with expectations for the next LIGO-Virgo-KAGRA
observing run. We find that, despite our model’s flexibility, both the source mass model
and cosmological parameters are correctly reconstructed. We predict a 11.2% measure- §
ment of H0, keeping all other cosmological parameters fixed, and a 6.4% measurement of §
H(z = 0.9) when fitting for multiple cosmological parameters (1 § σ uncertainties). This
astrophysically-agnostic spectral siren technique will be essential to arrive at precise
and unbiased cosmological constraints from GW source populations.
1. INTRODUCTION
afarah@uchicago.edu
Like light, GWs are redshifted as they propagate across the universe, thereby bearing imprints of the Universe’s cosmic expansion hisarXiv:2404.02210v4 [astro-ph.CO] 22 Aug 2024
2
tory. Unlike light, however, the form of GW
signals are known from first principles, directly
from the theory of general relativity. Furthermore, because GWs propagate across the
Universe without attenuation from intervening
matter, and because the properties of GW detectors are well characterized, GW selection effects are extremely well understood. This allows
for a precise estimate of each GW catalogs’ completeness and an unbiased measurement of the
true GW source population (Abbott et al. 2023;
Abbott et al. 2023; Essick 2023). Additionally,
the GW signals observed by the LIGO, Virgo,
and KAGRA detectors (Aasi et al. 2015; Acernese et al. 2014; Akutsu et al. 2021) provide
direct measurements of the distance to their
sources. This makes them “standard sirens”:
direct probes of cosmological parameters that
circumvent the need for a cosmological distance
ladder (Schutz 1986; Holz & Hughes 2005).
A well-known demonstration of standard
siren cosmology was the multi-messenger event
GW170817 (Abbott et al. 2017a; Coulter et al.
2017; Valenti et al. 2017; Tanvir et al. 2017),
whose clear association with a host galaxy provided a precise redshift measurement and allowed for a direct “bright siren” measurement of
the Hubble constant, H0 (Abbott et al. 2017b).
External redshift information can also come
from galaxy catalogs, which provide an ensemble of possible redshifts for each GW signal, allowing for a probabilistic “dark siren” measurement of H0 when multiple GW detections are
combined (Del Pozzo 2012; Chen et al. 2018;
Fishbach et al. 2019; Soares-Santos et al. 2019;
Gray et al. 2020; Abbott et al. 2021a,c; Gray
et al. 2022, 2023; Mastrogiovanni et al. 2023a;
Gair et al. 2023).
Electromagnetic information about GW
source redshifts need not be available in order
to use them as standard sirens, however. GW
signals provide direct measurements of each
source’s luminosity distance, DL, and redshifted
(detector frame) masses, mdet = msource(1 + z)
(e.g. Chen et al. 2019). Therefore, if the source
frame mass is known, each GW signal provides
a direct mapping between luminosity distance
and redshift, allowing for a measurement of the
expansion of the universe at the time the GW
signal was emitted, H(z).
In practice, the source-frame masses of individual GW signals are not known (unless tidal
information is available, e.g. Messenger & Read
2012; Chatterjee et al. 2021). It is, however,
possible to consider the population of compact
binaries at large and use known features in their
source-frame mass distribution to obtain selfcalibrated redshift estimates. The full mass distribution therefore acts analogously to an electromagnetic spectrum, in which the apparent
locations of spectral features relative to their
rest-frame locations provide a redshift measurement. The method of using the mass distribution of GW sources to measure cosmological
parameters has therefore been coined “spectral
sirens” (Ezquiaga & Holz 2022). Spectral sirens
were first demonstrated to be a feasible method
to measure the Hubble constant by Chernoff &
Finn (1993) and Taylor et al. (2012) using the
binary neutron star mass distribution, and extended to the binary black hole (BBH) mass distribution by Farr et al. (2019). Spectral siren
analyses have since been implemented by the
LIGO–Virgo–KAGRA Collaborations using the
latest GW catalog (Abbott et al. 2021c).
Central to the spectral siren methodology is
knowledge of the compact binary mass distribution. However, first principles models for mass
distributions of merging compact binaries are
not available: significant theoretical uncertainties exist about the shapes, locations, and very
existence of predicted features in the mass distribution (e.g. Zevin et al. 2017; Mapelli 2020;
Zevin et al. 2021; Marchant & Bodensteiner
2023). This includes uncertainties about potentially dominant features, such as the exis-
3
101 102
m1 [M]
10−2
10−1
100
101
dN
dm1 [M
−1
 Gpc
−3yr
−1
]
50 60 70 80 90 100
H0 [km/s/Mpc]
0.00
0.01
0.02
0.03
0.04
0.05
0.06
posterior density
Truth Gaussian process Power Law + Peak Broken Power Law
Figure 1. Spectral siren measurement for a simulated catalog with the correct parametric model (Power
Law + Peak, green dashed), a deliberately incorrect parametric model (Broken Power Law, pink solid)
and the non-parametric model presented in this work (Gaussian process, blue filled). The left panel shows the
recovered source frame primary mass distribution for each model, and the simultaneously-inferred posteriors
on H0 are shown in the right panel. The bands in the left panel represent the 90% credible intervals. The
mass distribution and H0 value used to generate the data are shown by a solid black line in each panel. The
deliberately incorrect parametric model fails to recover the true mass distribution and therefore produces
an estimate of H0 that is offset from the true value, whereas both the correct and non-parametric models
recover the mass distribution and H0. As the true mass distribution is unknown for real observations, using
a non-parametric model mitigates systematic uncertainty that would otherwise arise from mismodeling the
compact binary coalescence (CBC) population. §
õ
tence of a “pile-up” due to pulsational-pair instability, a pair-instability-driven upper mass
gap (Farmer et al. 2019), the maximum neutron star mass (Fryer & Kalogera 2001; Alsing et al. 2018), and the existence of a putative lower mass gap between neutron stars and
black holes (Ozel et al. ¨ 2010; Farr et al. 2011;
Farah et al. 2022). To this end, spectral siren
cosmology relies on simultaneously measuring a
source-frame mass spectrum alongside cosmological parameters. This is typically accomplished by adopting a phenomenological, parametric model for the mass distribution, usually
composed of power laws and Gaussians (e.g. Abbott et al. 2021c; Mastrogiovanni et al. 2023b).
Such parametric modeling of the compact binary mass distribution raises its own set of dangers. It is well known that different parametric models can generically yield very different
constraints on cosmological parameters (Abbott et al. 2021b, 2023). This is problematic: because the measured mass distribution
serves as the template by which to extract redshifts, a mismodeled mass distribution would
introduce systematic errors in inferred redshifts
and, in turn, systematically bias any resulting
cosmological inference (Ezquiaga & Holz 2022;
Mukherjee 2022; Mastrogiovanni et al. 2021;
Pierra et al. 2023).
The situation is demonstrated in Figure 1,
in which we perform spectral siren cosmology on a simulated population of binary black
holes. We reconstruct the mass distribution using two parametric models, one that contains
the true simulated mass distribution and one
that does not. While the former yields a measurement of H0 consistent with the true underlying value, the latter does not. Such systematic
4
biases may already be relevant, as cosmological
measurements by the LIGO-Virgo-KAGRA are
known to depend on the choice of mass model
used (Abbott et al. 2021c). Furthermore, these
biases may become a dominant source of uncertainty in the near future (Pierra et al. 2023).
The prospects of such a dominant systematic
uncertainty is troubling. If prior knowledge of
the mass distribution’s morphology (whether an
exact theoretical prediction or knowledge of the
correct parametric family of models) is a prerequisite for the spectral siren method, the effectiveness of such a technique would be significantly hampered.
In this work, we explicitly demonstrate that
no prior knowledge of the shape of the compact
binary coalescence (CBC) mass spectrum is necessary to use the spectral siren methodology.
We do this by inferring H(z) with a flexible,
non-parametric model for the mass distribution
of CBCs (blue shaded band in Figure 1). This
model makes minimal prior assumptions about
the shape of the mass distribution, enabling it
to accurately infer a wide range of morphologies
and remain agnostic to the astrophysical processes that give rise to features in the mass distribution. Despite its flexibility, our approach
is able to consistently obtain unbiased measurements of cosmological parameters, showing that
non-parametric methods are not only sufficient
for a spectral siren measurement, they can also
mitigate systematic effects in the measurement
caused by model misspecification.
The non-parametric mass model’s ability
to recover injected cosmological parameters
demonstrates that the information in the spectral siren measurement does not come from the
enforcement of specific features in the mass distribution. Rather, it is provided by the assumption that either all CBCs follow a common
mass distribution, or that any evolution of the
mass distribution with redshift does not exactly
mimic cosmology (Ezquiaga & Holz 2022).
We find that our non-parametric model allows
for a 11.2% measurement of § H0 and a 6.4% mea- §
surement of H(z = 0.9) during the fifth LIGO- §
Virgo-KAGRA observing run (O5), when the
detectors will reach their design sensitivity. We
highlight measurements of H0 within a ΛCDM
universe in order to benchmark the accuracy
and precision of our non-parametric method, as
well as explore the role of spectral sirens in elucidating the Hubble tension. However, a primary
utility of spectral siren measurements will be in
constraining H(z) under different cosmological
models, and at redshifts that are relatively inaccessible by electromagnetic observations, especially with next-generation gravitational-wave
detectors (You et al. 2021; Ezquiaga & Holz
2021, 2022; Chen et al. 2024).1
This paper is organized as follows: Section 2.1
describes the simulated dataset. Section 2.2 introduces the spectral siren method, demonstrating how cosmological parameters are inferred
from the mass distribution of GW sources. Section 2.3 describes the non-parametric mass distribution we develop for use within the spectral siren method. In Section 3, we present the
results of using parametric and non-parametric
mass distributions, as well as projections for future constraints on H(z). We discuss the implications of our results and outline future work in
Section 4.
This study was carried out using the reproducibility software
show your work!
(Luger
et al. 2021), which leverages continuous integration to programmatically download the data
from zenodo.org, create the figures, and compile
the manuscript. The icons next to each Figure
caption are hyperlinks that lead to the code
used to make that Figure (github icons), and to
the data behind the Figure (cylindrical icons).
1 See example spectral siren cosmological inference using parametric mass spectrum models:
https://github.com/ezquiaga/spectral sirens.
5
Some programatically-generated numbers in the
text also have these icons, which function in the
same way. We encourage readers to click these
hyperlinks to verify or reproduce the results and
methods of this work. The git repository associated to this study allows anyone to re-build the
entire manuscript, and is publicly available at
https://github.com/afarah18/spectral-sirenswith-GPs and https://zenodo.org/records/
11199928.
2. COSMOLOGY WITH AN
ASTROPHYSICALLY-AGNOSTIC MASS
MODEL
The spectral siren method functions by identifying the relationship between luminosity distance and redshift that causes all source frame
masses to follow a distribution that smoothly
varies as a function of time. This allows for
the simultaneous inference of both a mass distribution and cosmological parameters, even if
the form of the source-frame mass distribution
is not known in advance. As described above,
though, strongly parametrized models for the
mass distribution yield biased measurements of
cosmological parameters if they poorly approximate the true mass distribution of compact binaries. We aim to circumvent such biases and
instead model the population of GWs sources
in a flexible and astrophysically-agnostic way.
There exist several non-parametric methods
developed for this purpose (Tiwari 2021; Edelman et al. 2022; Sadiq et al. 2022; Rinaldi &
Del Pozzo 2022; Edelman et al. 2023; Mandel et al. 2019; Ray et al. 2023; Callister &
Farr 2023). While well-suited to infer the GW
source population with a fixed cosmology, several of these methods employ fixed features in
source frame mass, such as bin edges (Mandel
et al. 2019; Ray et al. 2023) or spline nodes
(Edelman et al. 2022). Since these locations
were chosen with a fixed cosmology, they risk
causing the inference to prefer the cosmological parameters assumed when choosing the feature locations. Indeed, Mastrogiovanni et al.
(2021) show how using fixed features can significantly bias cosmological inference within the
spectral siren methodology. We therefore opt
for a model of the source frame mass distribution that foregoes the need to define such features.
For this purpose, we construct a model with
a Gaussian process (GP), a common tool for
non-parametric inference. GPs define a random space of functions in which any subset of
function values are jointly Gaussian-distributed
(Rasmussen & Williams 2006). Their smoothness properties make them widely useful in GW
data analysis for regression problems, such as
modeling time-domain waveforms (Doctor et al.
2017; Huerta et al. 2018) and the neutron star
equation of state (Landry & Essick 2019), density estimation problems, such as estimating
posterior densities of single-event parameters
from parameter estimation samples (D’Emilio
et al. 2021), and as a prior on histogram bin
heights for population inference (Mandel et al.
2017; Li et al. 2021; Ray et al. 2023).
Our use case is slightly different from previous analyses: we utilize a GP as a prior on the
functions that describe the primary mass distribution of CBCs. This choice encodes very little
prior information about the shape of the mass
distribution, besides enforcing that it must be
smooth.
2.1. Simulated Data
To demonstrate the effectiveness of our GPbased mass distribution in agnostically inferring
both cosmological parameters and the population properties of GW sources, we apply our
methodology to a simulated dataset. By generating a catalog of GW sources from a known
population and cosmological model, we are able
to quantify the accuracy of our method. The
use of simulated data also enables us to make
projections for future datasets and safely ignore
dimensions such as spin that do not impact cos-
6
mological measurements but would otherwise
be important to simultaneously fit to avoid biases in population inference of real data, as
real data exhibit correlations between distance,
mass, and spin measurements (Biscoveanu et al.
2021).
We design our simulated catalog to match the
characteristics of the data expected from one
year of observation in O5. The BBHs in this
catalog are drawn from an underlying population described by the Power Law + Peak
mass distribution presented in Talbot & Thrane
(2018) and used in Abbott et al. (2019, 2023),
and follow the redshift distribution presented
in Callister et al. (2020), with hyperparameters consistent with those found in Abbott et al.
(2023). We assume the mass distribution does
not evolve across the redshift range to which the
O5 detectors will be sensitive. This assumption
is consistent with current data (Fishbach et al.
2021; van Son et al. 2022; Abbott et al. 2023),
in which no redshift evolution of the black hole
mass function is detected. At the same time,
a redshift-dependent mass function is a generic
astrophysical prediction, due either to changing
evolutionary environments or evolving mixture
fractions between distinct compact binary formation channels (Neijssel et al. 2019; van Son
et al. 2022; Torniamenti et al. 2024; Ye & Fishbach 2024). We discuss this possibility further
in Section 4, but leave it primarily for future
work.
We use the GWMockCat (Farah et al. 2023)
package to apply O5-like selection effects to the
drawn BBHs, generate realistic measurement
uncertainty, and produce sensitivity estimates
that are consistent with the simulated GW signals. We will use the term “event” to refer to
GW signals that pass the criteria for detection.
This process results in a catalog of Nev = 591 §
GW signals that pass the criteria for detection,
hereon called events. Additional details of the
data simulation, including the form of the injected population, are described in Appendix A.
2.2. The Spectral Siren Method
To simultaneously infer cosmological parameters and the population of GW sources, we
employ a hierarchical Bayesian analysis. This
allows us to undo the selection effects of GW
detectors to obtain a true, astrophysical population and constrain the cosmic expansion history.
Given a source population and background
cosmology described by hyperparameters Λ, the
likelihood of observing data {d} that contains
Nev detected GW signals, each with parameters
θi
, is (Loredo 2009; Taylor et al. 2012; Mandel
et al. 2019; Vitale et al. 2020)
p({d}, {θ}|Λ) ∝
e
−Nexp(Λ)Y
Nev
i
p(di
|θi)
dN
dtdetdθ
(θi
; Λ).
(1)
Here, Λ is the set of population parameters
hyper-parameters and dN
dtdetdθ
(θ; Λ) is the detector frame merger rate density of BBHs, conditioned on hyper-parameters Λ. Following Callister & Farr (2023), we use a semicolon to explicitly indicate that this is a function of Λ, not
a density over Λ. Nexp(Λ) is the expected number of detections given Λ and the GW detector sensitivity, and is calculated using a Monte
Carlo sum over Ninj found signals injected into
the data stream (see Essick & Fishbach 2021;
Essick & Farr 2022, for a detailed explanation
of this process).
In this work, we have restricted our analysis to
the BBH primary mass distribution. However,
the method can be trivially extended to the full
mass distribution of CBCs (e.g. Fishbach et al.
2020; Ezquiaga & Holz 2022). Additionally, Appendix B demonstrates that including the mass
ratio distribution in the fit does not change the
results of the analysis presented here.
7
Since parameters of individual events are not
perfectly measured, we marginalize over the
possible properties of each event. Practically,
this is done by a Monte Carlo average over the
posterior samples {θj}i of each event i and dividing out the prior used when inferring those
posterior samples, πPE(θ):
p({d}|Λ)
∝ e
−Nexp(Λ)Y
Nev
i
Z
dθi p(di
|θi)
dN
dtdetdθ
(θi
; Λ)
≈ e
−Nexp(Λ)Y
Nev
i
1
Nsamps
N
Xsamps
j=1
dN
dtdetdθ
(θj,i; Λ)
πPE(θj,i)
.
(2)
When combined with a prior p(Λ) (to be discussed below) on the population and cosmological parameters, the result is a posterior on
both the compact binary population and the
background cosmology. The full set of hyperparameters Λ therefore includes the shape of
the mass distribution as well as all cosmological parameters that dictate the DL–z relation:
the local expansion rate H0, the present fractional energy densities of dark matter ΩM, dark
energy ΩΛ, and radiation Ωr, and the equation
of state of dark energy w. In this work, we fix
ΩΛ = 1 − ΩM, Ωr = 0 and w = −1 and use uniform priors on H0 and ΩM, corresponding to a
flat ΛCDM cosmology.
The process by which we sample the likelihood
in Equation 1 is outlined in Appendix C.
2.3. Gaussian process-based mass distribution
In this Section, we give an overview of the
non-parametric mass model developed for this
work. Further details on this model, including
an introduction to GPs and a discussion of their
properties is given in Appendix C.
With the GP approach, the hyper-parameters
describing the mass distribution are the rate
at each event-level posterior sample’s source
frame mass, and the rate at each found injection’s source frame mass. The GP is p(Λ), the
prior on population parameters (except in the
case of cosmological parameters, which all have
uniform priors). This is demonstrated in Figure 2, where the left panel shows draws from
a GP, which are prior draws for the population inference. The smooth appearance of individual draws from the population prior, as
well as the absence of overdensities at specific
source frame mass values in the full prior distribution shown in Figure 2 demonstrate that
we have successfully fulfilled our goal to construct a model without predefined features in
source-frame mass. Combined with the population likelihood in Equation 1 the prior illustrated in the left panel of Figure 2 gives the
population posterior in the right panel.
The lack of data just below the minimum
black hole mass and just above the maximum
black hole mass, combined with the fact that
GW detectors are sensitive to objects at those
masses, causes the GP to learn a relatively low
merger rate at the edges of the mass distribution. On the other hand, there is both a
lack of data and little detector sensitivity at
masses above ∼ 100 M⊙ and below ∼ 5 M⊙.
The mass distribution is therefore uninformed
in this region and the GP reverts to its prior
distribution, which resembles random scatter
around the mean differential merger rate. Similar effects can be seen in other non-parametric
methods (Edelman et al. 2023; Callister &
Farr 2023). The combination of these two effects results in what appears as an uptick in
the merger rate below ∼ 5 M⊙ and above ∼
100 M⊙. However, this reversion to the prior is
uninformative for the H0 constraint and does
not affect inference on cosmological parameters. Additionally, the posterior on H0 is distinct from its prior distribution (uniform in the
range [30 km−1
s
−1 Mpc, 120 km−1
s
−1 Mpc], indicating that the data is informative despite the
flexibility of the population model.
8
We note that other non-parametric methods
may be adapted to avoid predefined features,
such as fitting for the locations of their features
simultaneously with the rest of the inference
(e.g. Tiwari 2021) or, in the case of splines, by
using a smoothing function that allows for features to occur at arbitrary locations appropriate
smoothing (e.g. Edelman et al. 2023).
The smoothness of a given GP is determined
by its kernel, which is a function that defines the covariance between input points in
the GP (in our case, two source frame mass
values). It defines the notion of similarity
between adjacent points and thereby encodes
our assumptions about the smoothness of the
source frame mass distribution (Rasmussen &
Williams 2006). Kernels themselves have parameters that determine their properties. In
our use case, these are one level further removed
from hyper-parameters, so we adopt the terminology used in Callister & Farr (2023) and call
them “hyper-hyper-parameters.” We fit these
hyper-hyper-parameters along with the hyperparameters Λ to minimize prior assumptions
about the form of the mass distribution.
3. RESULTS
In this Section we show that fitting an incorrect functional form to the mass distribution of
CBCs biases the inference of cosmological parameters when using the spectral siren methodology. We then demonstrate that our flexible
model alleviates this bias without the need to
know the morphology of the mass distribution
a priori. We illustrate this explicitly by using
three different models for the source-frame mass
distribution to infer the cosmic expansion rate
from the simulated catalog described in Section 2.1 and Appendix A. The three models are
as follows:
1. Power Law + Peak, which includes
the true mass distribution within its
hyper-prior,
2. the Broken Power Law model presented in Abbott et al. (2021b), as we do
not employ a high-mass truncation, which
does not include the true mass distribution within its hyper-prior, and
3. the flexible, GP-based model described
in Section 2.3, which is able to closely
approximate the morphology of the true
mass distribution, along with many other
morphologies.
For all models considered in this work, we assume the form of the redshift distribution used
to generate the data, described in Equation A3.
We have performed the analysis both with a
fixed redshift distribution and while simultaneously fitting for the redshift distribution and
find no qualitative differences in our conclusions: fitting for the redshift distribution broadens the inferred posteriors on H0 equally for all
mass models, but does not affect their mean values.
The results of fitting each model to the same
dataset are shown in Figure 1. The left panel
shows the inferred source-frame mass distribution for each of the considered models, and the
right panel shows the corresponding posteriors
on H0. We indicate the true underlying source
mass distribution and H0 value with solid black
lines in each panel.
The fits presented in Figure 1 are representative results from a single simulated catalog.
These provide insight into the full statistical results presented below. In particular, it can be
seen that the Broken Power Law (orange
curve) is inconsistent with the true value of H0:
in the run shown in Figure 1, the true value of
H0 is offset from the mean of the posterior by
2.7σ. In contrast, the § Power Law + Peak
and GP-based models (green and blue curves)
are consistent with the underlying truth. These
models recover mean values of H0 that are offset from the true value at 0.8σ§and 0.3σ, re- §
spectively. Additionally, the mass distribution
9
1 2 3 4 5
log(m1/M)
−10.0
−7.5
−5.0
−2.5
0.0
2.5
5.0
log

dN
d log
m1
/Gpc
−3yr
−1

Population Prior
1 2 3 4 5
log(m1/M)
Population Posterior
Figure 2. Draws from the Gaussian process (GP) used to model the mass distribution. The left panel
shows prior draws from the GP and the right panel shows posterior draws once the population inference is
performed on the simulated data. The posterior draws in the right panel are a subset of those used to create
the 90% credible intervals in Figure 1. §
õ
inferred with the GP-based model closely resembles the true, simulated distribution. This
indicates that using models that cannot accurately approximate the true mass distribution
will lead to a noticeable systematic bias in the
estimation of cosmological parameters.
This bias is not due to the need to know
the morphology of the mass distribution a priori, as the GP-based model recovers the correct
value of H0 despite making minimal assumptions about the mass distribution. In reality,
we do not know the true functional form of the
mass distribution, so it may be desirable to use a
non-parametric approach to avoid potential systematic errors introduced by choosing a parametric model that likely does not contain the
true mass distribution within its hyper-prior.
To obtain a quantitative measure of the systematic bias introduced by mis-modeling the
mass distribution, we repeat the parametric
analyses with 50 separate simulated catalogs of
∼ 1, 000 events each. We find that the Broken Power Law model produces an over- or
under-estimate of H0 at greater than 1σ 90%§
of the time, and the Power Law + Peak
model reaches the same level of bias only 26%§
of the time, meaning that the Broken Power
Law model produces a bias more than three
times as often as the Power Law + Peak
model. Additionally, we show in Appendix D
that the Broken Power Law model typically
overestimates H0 whereas the Power Law +
Peak model produces a roughly equal number
of over- and underestimates of H0. This demonstrates that mis-modeling the mass distribution
can introduce statistically significant systematic
biases into measurements of cosmological parameters.
Collectively, our results indicate that prior
knowledge of the shape of the mass distribution
is not required to perform an unbiased spectral
siren measurement, so long as strong assumptions about the shape of the mass distribution
are not made.
3.1. Projections for Future Measurements
Figure 1 demonstrates an expected 11.2%§
(1σ uncertainties) measurement of H0 after one
year of O5 using the GP-based spectral siren
method, and a 8% measurement with paramet- §
ric spectral sirens, demonstrating comparable
10
statistical uncertainties. However, we note that
the precision reached in O5 may lessen depending on the actual level of measurement uncertainty in individual events, and the existence (or
lack thereof) of a maximum mass feature, which
we have assumed to be present in our simulated
dataset. These numbers are estimated from a
fit to a single simulated catalog, but we find
similar levels of statistical uncertainty from fits
to different catalog realizations. By the time
of O5, the GW detector network is projected
to detect BBHs up to redshift ≈ 3, with most
sources lying near redshift ≃ 1.2 (Chen et al.
2021). Additionally, next-generation detectors
will be sensitive to sources up to redshift ∼ 100.
This means that future GW observations will
be more sensitive to H(z ≳ 1) than to H0, and
can therefore constrain several additional cosmological parameters (Chen et al. 2024). We
demonstrate this by repeating the same GPbased spectral siren analysis while also simultaneously fitting for the local matter density,
ΩM. The result is shown in Figure 3. We emphasize that these precise measurements over a
wide range in redshift enable precision estimation of additional cosmological parameters governing H(z).
We find O5 observations to be most sensitive
to H(z = 0.9), which is measured at 6 § .4%. The §
left panel of Figure 3 demonstrates a strong
anti-correlation between the ΩM and H0 posteriors, resulting in similarly informative constraints on the two parameters. This is because H0 controls the y-intercept of the H(z)
curves on the right panel, while ΩM informs
the slope of those curves; the same measurement of H(z ̸= 0) can be obtained by increasing
the slope while decreasing the y-intercept, and
vice versa. Similar behavior can be observed
in current measurements of the BBH redshift
distribution, which exhibits a tightening of the
posterior at z ∼ 0.2 with current observations
(Abbott et al. 2023; Callister & Farr 2023).
Next-generation detectors will be sensitive to
a larger range of redshifts (ET steering committee 2020; Evans et al. 2021), and will therefore break the degeneracy between cosmological
parameters and allow for tighter constraints on
both ΩM and H0. However, the small cosmological volume (and thus low number of mergers) at low redshift will generally limit the constraining power of spectral sirens at z = 0, potentially making this method more sensitive to
cosmological parameters that affect higher redshifts. Combining spectral sirens with other
methods that are sensitive to the local expansion rate, such as those that employ electromagnetic counterparts, may increase the precision of
GW standard sirens at all redshifts (e.g. Chen
et al. 2024).
4. DISCUSSION
GWs are unique cosmic messengers in that
they carry both redshift and distance information, making them remarkably clean probes of
the Universe’s expansion history calibrated directly by the theory of general relativity. However, the current method of determining GW
redshifts via the distribution of their source
masses (i.e. spectral sirens) employs an assumption on the shape of their population,
typically encapsulated by simplified parametric
functions. This choice, often presumed to be
necessary or fundamental to the method, may
introduce a systematic bias to a measurement
of the cosmological parameters that is otherwise
appealing for its unique elegance and simplicity.
In this work we show that a specific choice
of mass distribution is unnecessary to arrive at
informative and accurate posteriors on H0 and
ΩM. We do this by accurately measuring these
cosmological parameters with a highly flexible
model for the mass distribution. This reinforces
the notion that the information in the spectral
siren measurement comes from the assumption
that all GW sources come from the same population, a far less stringent statement than the
11
0.00
0.01
0.02
50 75 100
H0 [km/s/Mpc]
0.25
0.50
0.75
Ω
m
0.0 0.5 1.0
Ωm
0
1
2
0.0 0.5 1.0 1.5 2.0 2.5 3.0
z
0
100
200
300
400
500
H(z) [km/s/Mpc]
100 125 150
H(z = 0.9) [km/s/Mpc]
True value
Figure 3. Projected constraints on multiple cosmological parameters after one year of observing at the
LVK’s design sensitivity, using the Gaussian process-based spectral siren method. The right panel shows
the inferred expansion history of the universe, H(z). It will be measured most precisely at z = 0.9, as can §
be seen by the narrowing of the inferred H(z) curves there. The inset shows the posterior on H(z = 0.9).§
Black solid lines indicate the true value of H(z) in both the inset and main panel. The left panel shows the
two-dimensional posterior on H0 and ΩM, with the true value indicated by a black “+”. The two parameters
are strongly degenerate because of the multiple ways of measuring z = 0.9. Spectral sirens are particularly §
well suited for measuring cosmological parameters that affect the Universe at z ≳ 0.2. §
õ
assumption that we understand the exact astrophysical processes which give rise to that population (i.e. the physics governing compact binary formation and evolution).
Spectral sirens are particularly useful in the
context of the current Hubble tension: a disagreement between multiple methods of measuring the local expansion rate of the universe
(Freedman 2021). As this tension can only
be explained by non-standard physics or yetunknown systematic uncertainties in either the
cosmic distance ladder or cosmic microwave
background measurements, direct and independent probes of the local expansion—such
as those presented here—may help determine
whether the current discrepancy represents a
fundamental crack in our standard model of
physics and/or cosmology.
Neither the mechanism from which compact
binaries were formed, nor the physical processes within the mechanism, have been conclusively determined. The true functional form
of the mass distribution therefore remains elusive, meaning that systematic uncertainties arising from an incorrect choice for the form of the
mass distribution are inevitable. With current
observations, these systematic effects are likely
smaller than statistical uncertainties. However,
next-generation detectors will herald sufficient
GW observations to substantially decrease statistical uncertainty in these measurements; for
example, Pierra et al. (2023) show that incorrect
assumptions about the shape of the mass distribution can lead to ∼ 3σ systematic biases in H0
with catalogs of 2,000 events, although this bias
may be an overestimate as it does not include
measurement uncertainty of the GW parameters. Thus, non-parametric approaches may be
preferable to avoid the systematic errors associated with choosing a parametric model.
In parallel with this work, Maga˜na Hernandez & Ray (2024) performed a spectral siren
analysis on public LVK data using histogram
bins defined at fixed locations in source-frame
12
mass to flexibly measure the BBH mass distribution (as originally presented in Mandel et al.
2017; Ray et al. 2023). Both our method and
theirs employ GPs. In our approach, the black
hole mass function is itself described by a Gaussian process, with no predefined features. In
Maga˜na Hernandez & Ray (2024), on the other
hand, the mass distribution is fundamentally
a binned piecewise constant function, with a
GP prior governing the relative heights of these
bins. While this binned model is flexible, sharp
bin edges at predefined locations nevertheless
constitute unphysical features. These features
may yield overly optimistic constraints on cosmological parameters, possibly explaining the
increase in precision that Maga˜na Hernandez
& Ray (2024) find relative to the parametric
analysis on the exact same dataset performed
in Abbott et al. (2021c). Maga˜na Hernandez
& Ray (2024) also include a binned reconstruction of the BBH merger rate as a function of
redshift, which we fix or model parametrically
in our own work. We stress, though, that this
is not an intrinsic limitation of our method; one
could straightforwardly adopt a second Gaussian process to govern the overall scaling of the
merger rate with redshift.
More interesting is the possibility that the
black hole mass distribution itself evolves with
redshift. As demonstrated in Ezquiaga & Holz
(2022), the degeneracy between an evolving
mass distribution and the expansion of the universe can be broken provided that there are
multiple features present in the mass distribution, and that we do not live in a fine-tuned
universe where the evolutionary effects governing the CBC mass distribution perfectly mimick the effects of cosmological redshift. The
first condition (multiple features) is known to
be met in current data (Abbott et al. 2023),
with three robust features (Farah et al. 2023):
a maximum black hole mass and overdensities at ∼ 10 M⊙ and ∼ 35 M⊙. It is also
predicted by many population synthesis studies, (e.g. Mapelli & Giacobbo 2018; Giacobbo
et al. 2018; van Son et al. 2023). The latter
scenario—with features identically and monotonically shifting to higher masses with increasing redshift—would be astrophysically unlikely
as the locations of features in the mass distribution are each thought to be governed by fundamentally different physical processes (Mapelli
2020). Extensions to the non-parametric methods presented here will allow for arbitrary redshift evolution. Additionally, since Gaussian
processes naturally scale to multiple data dimensions (Rasmussen & Williams 2006), the
method presented here can easily be generalized
to fit the redshift dependence of the mass distribution. Future work will extend the method
developed here to mass distributions that are
allowed to evolve with redshift. When applying an evolving mass distribution model to a
dataset that exhibits evolution, we expect errors
on cosmological parameters to broaden. Noticeable redshift evolution in the mass distribution
is expected to occur above z ≃ 1.5, (van Son
et al. 2022), which is not yet relevant in current
data or in expected O5 data, but will certainly
be visible in next-generation detectors.
Because GW observations are the only data
input to spectral sirens, they are sensitive to the
expansion history of the universe over a wide
range of cosmological redshift, rather than just
the local expansion H0. We have shown this
by simultaneously measuring ΩM and H0; the
method can be trivially expanded to constrain
additional cosmological parameters that govern
H(z), such as the dark energy equation of state
parameter, w. It is also possible to use a nonΛCDM cosmological model for H(z), with different parameters entirely. It may also be possible to forego the need for a parametric representation of H(z) altogether, for example by using
bins in luminosity distance. A similar technique
using redshift bins is commonly used in cosmo-
13
logical measurements using galaxy surveys and
type 1a supernovae (e.g. Perlmutter & Schmidt
2003; Anderson et al. 2014; Aghamousa et al.
2016), but we have not pursued that possibility in this work. Such a method would likely
increase uncertainties on H(z), especially for
z ≳ 1.5. We find that for the fifth LIGO-VirgoKAGRA observing run, spectral sirens will be
most constraining at z = 0.9. This redshift is §
larger than the expected redshifts of detectable
electromagnetic counterparts of binary neutron
star mergers (Kiendrebeogo et al. 2023), implying that upgrades to current GW detectors will
allow the spectral siren method to probe H(z)
at otherwise unexplored distances by GWs.
Proposed next-generation GW detectors such
as Cosmic Explorer and Einstein Telescope will
be sensitive to CBCs across cosmic time (out to
z ∼ 100) (ET steering committee 2020; Evans
et al. 2021). Future cosmological surveys, such
as those enabled by the Nancy Grace Roman
Space Telescope and the Vera Rubin Observatory, are expected to be able to precisely measure H(z) to z ∼ 3 (Spergel et al. 2015), making
the spectral siren method uniquely positioned to
measure the expansion of the universe at high
redshift. When combined with bright and dark
siren methods, the low-redshift expansion history will also be well-constrained (Chen et al.
2024). Sensitivity to high redshifts is a feature
of the spectral siren method in general, and nonparametric methods such as the one presented
here will be imperative to avoid systematic biases in spectral siren cosmology.
The authors thank Reed Essick, Ben Farr, Maya
Fishbach, Utkarsh Mali, and Colm Talbot for
helpful conversations. A.M.F. is supported by
the National Science Foundation Graduate Research Fellowship Program under Grant No.
DGE-1746045. J.M.E. is supported by the European Union’s Horizon 2020 research and innovation program under the Marie SklodowskaCurie grant agreement No. 847523 INTERACTIONS, and by VILLUM FONDEN (grant
no. 53101 and 37766). M.Z. gratefully acknowledges funding from the Brinson Foundation in support of astrophysics research at the
Adler Planetarium. D.E.H is supported by
NSF grants AST-2006645 and PHY-2110507, as
well as by the Kavli Institute for Cosmological
Physics through an endowment from the Kavli
Foundation and its founder Fred Kavli. The
Tycho supercomputer hosted at the SCIENCE
HPC center at the University of Copenhagen
was used for supporting this work. This material is based upon work supported by NSF’s
LIGO Laboratory which is a major facility fully
funded by the National Science Foundation.
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
Software: numpyro (Phan et al. 2019;
Bingham et al. 2019), tinygp (ForemanMackey 2021), arviz (Kumar et al. 2019), jax,
show your work!
(Luger et al. 2021)
REFERENCES
Aasi, J., Abbott, B. P., Abbott, R., et al. 2015,
Classical and Quantum Gravity, 32, 074001,
doi: 10.1088/0264-9381/32/7/074001
Abbott, B. P., Abbott, R., Abbott, T. D., et al.
2019, The Astrophysical Journal Letters, 882,
L24, doi: 10.3847/2041-8213/ab3800
—. 2020a, LIGO-T2000012-v2: Noise curves used
for Simulations in the update of the Observing
Scenarios Paper.
https://dcc.ligo.org/LIGO-T2000012-v2/public
—. 2020b, Living Reviews in Relativity, 23, 3,
doi: 10.1007/s41114-020-00026-9
—. 2017a, The Astrophysical Journal, 848, L12,
doi: 10.3847/2041-8213/aa91c9
—. 2017b, Nature, 551, 85,
doi: 10.1038/nature24471
—. 2021a, The Astrophysical Journal, 909, 218,
doi: 10.3847/1538-4357/abdcb7
14
Abbott, R., Abbott, T. D., Abraham, S., et al.
2021b, The Astrophysical Journal Letters, 913,
L7, doi: 10.3847/2041-8213/abe949
Abbott, R., Abbott, T. D., Acernese, F., et al.
2023, Physical Review X, 13, 011048,
doi: 10.1103/PhysRevX.13.011048
Abbott, R., Abbott, T. D., Acernese, F., et al.
2023, Physical Review X, 13, 041039,
doi: 10.1103/PhysRevX.13.041039
Abbott, R., Abe, H., Acernese, F., et al. 2021c,
Constraints on the cosmic expansion history
from GWTC-3, arXiv,
doi: 10.48550/arXiv.2111.03604
Acernese, F., Agathos, M., Agatsuma, K., et al.
2014, Classical and Quantum Gravity, 32,
024001, doi: 10.1088/0264-9381/32/2/024001
Adachi, M., & Kasai, M. 2012, Progress of
Theoretical Physics, 127, 145,
doi: 10.1143/PTP.127.145
Aghamousa, A., Aguilar, J., Ahlen, S., et al. 2016,
The DESI Experiment Part I:
Science,Targeting, and Survey Design, arXiv.
http://arxiv.org/abs/1611.00036
Akutsu, T., Ando, M., Arai, K., et al. 2021,
Progress of Theoretical and Experimental
Physics, 2021, 05A101,
doi: 10.1093/ptep/ptaa125
Alsing, J., Silva, H. O., & Berti, E. 2018, Monthly
Notices of the Royal Astronomical Society, 478,
1377, doi: 10.1093/mnras/sty1065
Anderson, L., Aubourg, E., Bailey, S., et al. 2014,
Monthly Notices of the Royal Astronomical
Society, 441, 24, doi: 10.1093/mnras/stu523
Bingham, E., Chen, J. P., Jankowiak, M., et al.
2019, Journal of Machine Learning Research,
20, 1. http://jmlr.org/papers/v20/18-403.html
Biscoveanu, S., Talbot, C., & Vitale, S. 2021,
arXiv:2111.13619 [astro-ph, physics:gr-qc].
http://arxiv.org/abs/2111.13619
Callister, T., Fishbach, M., Holz, D. E., & Farr,
W. M. 2020, The Astrophysical Journal, 896,
L32, doi: 10.3847/2041-8213/ab9743
Callister, T. A., & Farr, W. M. 2023, A
Parameter-Free Tour of the Binary Black Hole
Population, arXiv,
doi: 10.48550/arXiv.2302.07289
Chatterjee, D., Hegade K. R., A., Holder, G.,
et al. 2021, PhRvD, 104, 083528,
doi: 10.1103/PhysRevD.104.083528
Chen, H.-Y., Ezquiaga, J. M., & Gupta, I. 2024.
https://arxiv.org/abs/2402.03120
Chen, H.-Y., Fishbach, M., & Holz, D. E. 2018,
Nature, 562, 545,
doi: 10.1038/s41586-018-0606-0
Chen, H.-Y., Holz, D. E., Miller, J., et al. 2021,
Classical and Quantum Gravity, 38, 055010,
doi: 10.1088/1361-6382/abd594
Chen, X., Li, S., & Cao, Z. 2019, Monthly Notices
of the Royal Astronomical Society, 485, L141,
doi: 10.1093/mnrasl/slz046
Chernoff, D. F., & Finn, L. S. 1993, The
Astrophysical Journal, 411, L5,
doi: 10.1086/186898
Coulter, D. A., Foley, R. J., Kilpatrick, C. D.,
et al. 2017, Science, 358, 1556,
doi: 10.1126/science.aap9811
Del Pozzo, W. 2012, Physical Review D, 86,
043011, doi: 10.1103/PhysRevD.86.043011
D’Emilio, V., Green, R., & Raymond, V. 2021,
Monthly Notices of the Royal Astronomical
Society, 508, 2090, doi: 10.1093/mnras/stab2623
Doctor, Z., Farr, B., Holz, D. E., & P¨urrer, M.
2017, Physical Review D, 96, 123011,
doi: 10.1103/PhysRevD.96.123011
Edelman, B., Doctor, Z., Godfrey, J., & Farr, B.
2022, The Astrophysical Journal, 924, 101,
doi: 10.3847/1538-4357/ac3667
Edelman, B., Farr, B., & Doctor, Z. 2023, The
Astrophysical Journal, 946, 16,
doi: 10.3847/1538-4357/acb5ed
Essick, R. 2023, PhRvD, 108, 043011,
doi: 10.1103/PhysRevD.108.043011
Essick, R., & Farr, W. 2022, Precision
Requirements for Monte Carlo Sums within
Hierarchical Bayesian Inference, Tech. rep.
https://ui.adsabs.harvard.edu/abs/
2022arXiv220400461E
Essick, R., & Fishbach, M. 2021, On Estimating
Rates from Monte-Carlo Integrals over Injection
Sets. https://dcc.ligo.org/T2000100
—. 2024, The Astrophysical Journal, 962, 169,
doi: 10.3847/1538-4357/ad1604
ET steering committee, e. a. 2020, Einstein
Telescope: Science Case, Design Study and
Feasibility Report, Official document
ET-0028A-20. https:
//apps.et-gw.eu/tds/?content=3&r=17196
15
Evans, M., Adhikari, R. X., Afle, C., et al. 2021, A
Horizon Study for Cosmic Explorer: Science,
Observatories, and Community,
doi: 10.48550/arXiv.2109.09882
Ezquiaga, J. M., & Holz, D. E. 2021, Astrophys. J.
Lett., 909, L23, doi: 10.3847/2041-8213/abe638
—. 2022, Physical Review Letters, 129, 061102,
doi: 10.1103/PhysRevLett.129.061102
Farah, A., Fishbach, M., Essick, R., Holz, D. E., &
Galaudage, S. 2022, The Astrophysical Journal,
931, 108, doi: 10.3847/1538-4357/ac5f03
Farah, A. M., Edelman, B., Zevin, M., et al. 2023,
The Astrophysical Journal, 955, 107,
doi: 10.3847/1538-4357/aced02
Farmer, R., Renzo, M., de Mink, S. E., Marchant,
P., & Justham, S. 2019, The Astrophysical
Journal, 887, 53,
doi: 10.3847/1538-4357/ab518b
Farr, W. M., Fishbach, M., Ye, J., & Holz, D. E.
2019, The Astrophysical Journal, 883, L42,
doi: 10.3847/2041-8213/ab4284
Farr, W. M., Sravan, N., Cantrell, A., et al. 2011,
741, 103, doi: 10.1088/0004-637X/741/2/103
Fishbach, M., Essick, R., & Holz, D. E. 2020, The
Astrophysical Journal, 899, L8,
doi: 10.3847/2041-8213/aba7b6
Fishbach, M., Gray, R., Maga˜na Hernandez, I.,
et al. 2019, The Astrophysical Journal, 871,
L13, doi: 10.3847/2041-8213/aaf96e
Fishbach, M., & Holz, D. E. 2017, The
Astrophysical Journal, 851, L25,
doi: 10.3847/2041-8213/aa9bf6
Fishbach, M., Doctor, Z., Callister, T., et al. 2021,
The Astrophysical Journal, 912, 98,
doi: 10.3847/1538-4357/abee11
Foreman-Mackey, D. 2021, tinygp — tinygp.
https://tinygp.readthedocs.io/en/stable/
Foreman-Mackey, D., Agol, E., Ambikasaran, S.,
& Angus, R. 2017, The Astronomical Journal,
154, 220, doi: 10.3847/1538-3881/aa9332
Freedman, W. L. 2021, The Astrophysical
Journal, 919, 16, doi: 10.3847/1538-4357/ac0e95
Fryer, C. L., & Kalogera, V. 2001, The
Astrophysical Journal, 554, 548,
doi: 10.1086/321359
Gair, J. R., Ghosh, A., Gray, R., et al. 2023, The
Astronomical Journal, 166, 22,
doi: 10.3847/1538-3881/acca78
Giacobbo, N., Mapelli, M., & Spera, M. 2018,
Monthly Notices of the Royal Astronomical
Society, 474, 2959, doi: 10.1093/mnras/stx2933
Gray, R., Messenger, C., & Veitch, J. 2022,
Monthly Notices of the Royal Astronomical
Society, 512, 1127, doi: 10.1093/mnras/stac366
Gray, R., Hernandez, I. M., Qi, H., et al. 2020,
Physical Review D, 101, 122001,
doi: 10.1103/PhysRevD.101.122001
Gray, R., Beirnaert, F., Karathanasis, C., et al.
2023, Journal of Cosmology and Astroparticle
Physics, 2023, 023,
doi: 10.1088/1475-7516/2023/12/023
Handcock, M. S., & Stein, M. L. 1993,
Technometrics, 35, 403, doi: 10.2307/1270273
Hoffman, M. D., & Gelman, A. 2011, The
No-U-Turn Sampler: Adaptively Setting Path
Lengths in Hamiltonian Monte Carlo, arXiv.
http://arxiv.org/abs/1111.4246
Holz, D. E., & Hughes, S. A. 2005, The
Astrophysical Journal, 629, 15,
doi: 10.1086/431341
Huerta, E. A., Moore, C. J., Kumar, P., et al.
2018, Physical Review D, 97, 024031,
doi: 10.1103/PhysRevD.97.024031
Kiendrebeogo, R. W., Farah, A. M., Foley, E. M.,
et al. 2023, Updated observing scenarios and
multi-messenger implications for the
International Gravitational-wave Network’s O4
and O5, arXiv, doi: 10.48550/arXiv.2306.09234
Kumar, R., Carroll, C., Hartikainen, A., &
Martin, O. 2019, Journal of Open Source
Software, 4, 1143, doi: 10.21105/joss.01143
Landry, P., & Essick, R. 2019, Physical Review D,
99, 084049, doi: 10.1103/PhysRevD.99.084049
Li, Y.-J., Wang, Y.-Z., Han, M.-Z., et al. 2021,
The Astrophysical Journal, 917, 33,
doi: 10.3847/1538-4357/ac0971
Loredo, T. 2009, 213, 211.04. https://ui.adsabs.
harvard.edu/abs/2009AAS...21321104L
Luger, R., Bedell, M., Foreman-Mackey, D., et al.
2021, arXiv e-prints, arXiv:2110.06271.
https://arxiv.org/abs/2110.06271
Maga˜na Hernandez, I., & Ray, A. 2024, Beyond
Gaps and Bumps: Spectral Siren Cosmology
with Non-Parametric Population Models.
https://ui.adsabs.harvard.edu/abs/
2024arXiv240402522M
16
Mandel, I., Farr, W. M., Colonna, A., et al. 2017,
Monthly Notices of the Royal Astronomical
Society, 465, 3254, doi: 10.1093/mnras/stw2883
Mandel, I., Farr, W. M., & Gair, J. R. 2019,
Monthly Notices of the Royal Astronomical
Society, 486, 1086, doi: 10.1093/mnras/stz896
Mapelli, M. 2020, Frontiers in Astronomy and
Space Sciences, 7, 38,
doi: 10.3389/fspas.2020.00038
Mapelli, M., & Giacobbo, N. 2018, Monthly
Notices of the Royal Astronomical Society, 479,
4391, doi: 10.1093/mnras/sty1613
Marchant, P., & Bodensteiner, J. 2023, The
Evolution of Massive Binary Stars, arXiv.
http://arxiv.org/abs/2311.01865
Mastrogiovanni, S., Leyde, K., Karathanasis, C.,
et al. 2021, Physical Review D, 104, 062009,
doi: 10.1103/PhysRevD.104.062009
Mastrogiovanni, S., Laghi, D., Gray, R., et al.
2023a, Physical Review D, 108, 042002,
doi: 10.1103/PhysRevD.108.042002
Mastrogiovanni, S., Pierra, G., Perri`es, S., et al.
2023b, ICAROGW: A python package for
inference of astrophysical population properties
of noisy, heterogeneous and incomplete
observations, arXiv,
doi: 10.48550/arXiv.2305.17973
Messenger, C., & Read, J. 2012, Physical Review
Letters, 108, 091101,
doi: 10.1103/PhysRevLett.108.091101
Mukherjee, S. 2022, Mon. Not. Roy. Astron. Soc.,
515, 5495, doi: 10.1093/mnras/stac2152
Neijssel, C. J., Vigna-G´omez, A., Stevenson, S.,
et al. 2019, Monthly Notices of the Royal
Astronomical Society, 490, 3740,
doi: 10.1093/mnras/stz2840
Perlmutter, S., & Schmidt, B. P. 2003, Supernovae
and Gamma-Ray Bursters, 598, 195,
doi: 10.1007/3-540-45863-8 11
Phan, D., Pradhan, N., & Jankowiak, M. 2019,
Composable Effects for Flexible and
Accelerated Probabilistic Programming in
NumPyro, doi: 10.48550/arXiv.1912.11554
Pierra, G., Mastrogiovanni, S., Perri`es, S., &
Mapelli, M. 2023, A Study of Systematics on
the Cosmological Inference of the Hubble
Constant from Gravitational Wave Standard
Sirens, arXiv, doi: 10.48550/arXiv.2312.11627
Planck Collaboration, Ade, P. A. R., Aghanim,
N., et al. 2016, Astronomy and Astrophysics,
594, A13, doi: 10.1051/0004-6361/201525830
Rasmussen, C. E., & Williams, C. K. I. 2006,
Gaussian processes for machine learning,
Adaptive computation and machine learning
(Cambridge, Mass: MIT Press)
Ray, A., Maga˜na Hernandez, I., Mohite, S.,
Creighton, J., & Kapadia, S. 2023,
Non-parametric inference of the population of
compact binaries from gravitational wave
observations using binned Gaussian processes,
Tech. rep., doi: 10.48550/arXiv.2304.08046
Rinaldi, S., & Del Pozzo, W. 2022, Monthly
Notices of the Royal Astronomical Society, 509,
5454, doi: 10.1093/mnras/stab3224
Sadiq, J., Dent, T., & Wysocki, D. 2022, Physical
Review D, 105, 123014,
doi: 10.1103/PhysRevD.105.123014
Schutz, B. F. 1986, Nature, 323, 310,
doi: 10.1038/323310a0
Simpson, D. 2022, Un gar¸con pas comme les autres
(Bayes) - Priors part 4: Specifying priors that
appropriately penalise complexity. https://
dansblog.netlify.app/posts/2022-08-29-priors4/
priors4.html#the-dream-pc-priors-in-practice
Simpson, D., Rue, H., Riebler, A., Martins, T. G.,
& Sørbye, S. H. 2017, Statistical Science, 32, 1,
doi: 10.1214/16-STS576
Soares-Santos, M., Palmese, A., Hartley, W., et al.
2019, The Astrophysical Journal Letters, 876,
L7, doi: 10.3847/2041-8213/ab14f1
Spergel, D., Gehrels, N., Baltay, C., et al. 2015,
Wide-Field InfrarRed Survey
Telescope-Astrophysics Focused Telescope
Assets WFIRST-AFTA 2015 Report, arXiv.
http://arxiv.org/abs/1503.03757
Stein, M. L. 1999, Interpolation of Spatial Data,
Springer Series in Statistics (New York, NY:
Springer), doi: 10.1007/978-1-4612-1494-6
Talbot, C., & Thrane, E. 2018, The Astrophysical
Journal, 856, 173,
doi: 10.3847/1538-4357/aab34c
Tanvir, N. R., Levan, A. J., Gonz´alez-Fern´andez,
C., et al. 2017, ApJL, 848, L27,
doi: 10.3847/2041-8213/aa90b6
Taylor, S. R., Gair, J. R., & Mandel, I. 2012,
Phys. Rev. D, 85, 023535,
doi: 10.1103/PhysRevD.85.023535
17
Tiwari, V. 2021, Classical and Quantum Gravity,
38, 155007, doi: 10.1088/1361-6382/ac0b54
Torniamenti, S., Mapelli, M., P´erigois, C., et al.
2024, arXiv e-prints, arXiv:2401.14837,
doi: 10.48550/arXiv.2401.14837
Valenti, S., Sand, J., D., Yang, S., et al. 2017, The
Astrophysical Journal, 848, L24,
doi: 10.3847/2041-8213/aa8edf
van Son, L. A. C., Mink, S. E. d., Chru´sli´nska, M.,
et al. 2023, The Astrophysical Journal, 948,
105, doi: 10.3847/1538-4357/acbf51
van Son, L. A. C., de Mink, S. E., Callister, T.,
et al. 2022, The Astrophysical Journal, 931, 17,
doi: 10.3847/1538-4357/ac64a3
Vitale, S., Gerosa, D., Farr, W. M., & Taylor,
S. R. 2020, Inferring the properties of a
population of compact binaries in presence of
selection effects,
doi: 10.1007/978-981-15-4702-7 45-1
Ye, C. S., & Fishbach, M. 2024, arXiv e-prints,
arXiv:2402.12444,
doi: 10.48550/arXiv.2402.12444
You, Z.-Q., Zhu, X.-J., Ashton, G., Thrane, E., &
Zhu, Z.-H. 2021, Astrophys. J., 908, 215,
doi: 10.3847/1538-4357/abd4d4
Zevin, M., Pankow, C., Rodriguez, C. L., et al.
2017, The Astrophysical Journal, 846, 82,
doi: 10.3847/1538-4357/aa8408
Zevin, M., Bavera, S. S., Berry, C. P. L., et al.
2021, ApJ, 910, 152,
doi: 10.3847/1538-4357/abe40e
Ozel, F., Psaltis, D., Narayan, R., & McClintock, ¨
J. E. 2010, 725, 1918,
doi: 10.1088/0004-637X/725/2/1918
18
APPENDIX
A. DETAILS OF DATA SIMULATION
The exact form of the injected population is
dN
dm1dz
∝ p(m1|Λ¯m)p(z|Λ¯
z, H0, ΩM), (A1)
where
p(m1, m2|Λ¯m) ∝ S(mmin, mmax)

fpeake
− 1
2
(
m1−µ
σ
)
2
Ng + (1 − fpeak)mα
1 Npl
, (A2)
p(z|H0, ΩM) ∝
dVC
dz
1
1 + z
(1 + z)
α
z
1 + 
1+z
1+zp
αz+βz
. (A3)
Here, VC(H0, ΩM) is the comoving volume for given cosmological parameters H0 and ΩM, and Λ¯m =
{α, mmin, mmax, µ, σ, fpeak} are the (hyper-)parameters describing the power law in primary mass,
minimum and maximum black hole mass, Gaussian peak location and width, and fraction of events
in the Gaussian peak, respectively. S is a smoothing function at low and high masses, and Npl
and Ng are the normalizations between mmin and mmax for the power law component and truncated
Gaussian component, respectively. The smoothing creates support for masses below mmin and above
mmax. Λ¯
z = {zp, αz, βz} are the parameters governing the peak of the redshift distribution, low-z
power law slope, and high-z power law slope. When generating the simulated events, we have fixed
α = −2.7, mmax = 78 M⊙, mmin = 10 M⊙, µ = 30 M⊙, σ = 7.0 M⊙, fpeak = 0.05, zp = 2.4,
αz = 1.0, and βz = 3.4. These choices correspond to the maximum a posteriori values obtained
by an analysis of GWTC-3 data using the Power Law + Peak model (Abbott et al. 2023). For
simplicity, we assume a uniform mass ratio distribution. Thus, θ = {m1, z}. We consistently apply
these assumptions to the data generation process and the population inference. We do not fit for or
simulate spins, as they do not redshift and hence do not carry additional cosmological information,
and we fix the distribution of mass ratios.
We use cosmological parameters H0= 67.66 km§−1
s
−1 Mpc, ΩM= 0.3, and ΩΛ = 1−ΩM, consistent
with those found by Planck Collaboration et al. (2016). We emphasize, however, that the choice of
cosmological parameters for data generation is arbitrary and does not impact the results, since we
are concerned only with the ability of our method to recover the injected values. Throughout the
data generation and inference, we use the approximations presented in Adachi & Kasai (2012) to
efficiently convert between DL and z for a given set of cosmological parameters ΩM and H0.
We do not include neutron stars in our simulation set, as their contribution to the spectral siren
measurement is expected to be subdominant in O5. However, if a lower mass gap between the
heaviest neutron stars and lightest black holes exists, it will provide an additional feature with which
to inform the measurement, and will be the most informative feature for spectral siren measurements
with next-generation detectors (Ezquiaga & Holz 2022).
After passing the simulated events through projected detector selection effects, the resulting catalog
has 591 events, consistent with the numbers projected for O5 by § Kiendrebeogo et al. (2023). We
19
101 102
m1 [M]
10−15
10−13
10−11
10−9
10−7
dN
dm1 [M
−1
 Gpc
−3yr
−1
]
50 60 70 80 90 100
H0 [km/s/Mpc]
0.00
0.02
0.04
0.06
0.08
0.10
posterior density
Truth Do not fit for secondary mass Fit for secondary mass
Figure 4. Comparison of a parametric spectral siren analysis performed while fitting for the distributions
of primary and secondary masses (magenta solid) and primary masses only (green dashed). The posterior
on H0 is relatively unchanged between the two, and only minor differences are observed in the mass spectra. §
õ
use the software package GWMockCat (Farah et al. 2023) to simulate posterior samples for these
events with measurement uncertainties typical of those expected from O5 detectors. GWMockCat also
simulates a set of software injections, which we use to estimate selection effects in the inference.
To determine the detectability of both injections and simulated events in O5, we use the projected
O5 LIGO power spectral density (Abbott et al. 2020a,b) for a single detector to calculate observed
signal-to-noise ratios ρobs, and we consider events and injections with a single-detector SNR ρobs > 8
to be detectable. The full procedure for this mock data generation process is described in Fishbach
& Holz (2017); Farah et al. (2023); Essick & Fishbach (2024).
B. EFFECTS OF FITTING FOR SECONDARY MASS
We examine the effect of only fitting the distribution of primary masses on our results. To do so,
we perform two spectral siren analyses: one that includes a fit to mass ratio, and one that does
not. Both analyses use the parametric, Power Law + Peak model for the distribution of primary
masses. We model the distribution of mass ratios with a power law, similarly to the majority of
analyses presented in Abbott et al. (2021b, 2023).
We use the same set of simulated events for both analyses. These are generated in the same way as
described in Section 2.1. The inference results are shown in Figure 4. We find the posteriors on H0
to be similar between the two cases. Additionally, the recovered mass spectra are nearly identical.
We therefore conclude that fitting for mass ratios does not significantly impact our main conclusions.
C. GAUSSIAN PROCESS-BASED MASS DISTRIBUTION
In this Section, we discuss the properties of the GP-based mass distribution and describe our
modeling choices in more detail.
Practically, the difference in the inference of the population when using a GP versus other modeling choices is that the population model (dN/dtdetdθi(θi
; Λ) in Equation 1) is determined directly
20
by a realization of the GP, rather than by a handful of hyper-parameters Λ and evaluated on an
analytical function. In other words, when using parametric models, dN/dtdetdθi(θi
; Λ) is calculated
by evaluating a specific functional form described by a small set of hyper-parameters. With the
GP approach, the hyper-parameters describing the mass distribution are the rate at each event-level
posterior sample’s source frame mass, and the rate at each found injection’s source frame mass. The
GP is p(Λ), the prior on population parameters (except in the case of cosmological parameters, which
all have uniform priors).
Because the GP is defined only at specific data points, we have NevM +Ninj mass hyper-parameters,
where M is the number of posterior samples per event and Ninj is the number of injections used to
calculate the selection function (see e.g. Vitale et al. 2020; Essick & Fishbach 2021). In this way, our
GP-based mass distribution is similar to the autoregressive population models used in Callister &
Farr (2023). Indeed, an autoregressive process is a GP with a specific choice of kernel.
The kernel is a function that defines the covariance between input points in the GP (in our case, two
source frame mass values). It defines the notion of similarity between adjacent points and thereby
encodes our assumptions about the smoothness of the source frame mass distribution (Rasmussen &
Williams 2006). We use a Mat´ern kernel (Handcock & Stein 1993; Stein 1999) with ν = 5/2, but
have repeated the analysis with ν = 3/2 and ∞, finding little impact on the results, except that
the ν = ∞ case (also called the squared exponential kernel) produces a slightly more jagged mass
distribution. In addition to the mean, Mat´ern kernels have two parameters that determine their
properties: a length scale l and a variance s. In our use case, these are one level further removed
from hyper-parameters, so we adopt the terminology used in Callister & Farr (2023) and call them
“hyper-hyper-parameters.” We fit these hyper-hyper-parameters along with the hyper-parameters Λ
to minimize prior assumptions about the form of the mass distribution. We use penalized-complexity
priors on the hyper-hyper-parameters to enforce that the model does not create small-scale structure
uninformed by data, thereby avoiding over-fitting (Simpson et al. 2017; Simpson 2022). Explicitly,
the priors on l and s are Fr´echet and Gamma distributions, respectively, and are defined to have
less than 5% support for correlation lengths smaller than the average spacing between event-level
posterior means.
The time to evaluate a GP is notorious for scaling as the cube of the number of data points, making
GPs unwieldy with large data sets, such as the O(109
) posterior samples and software injections
expected for O5. We therefore make two approximations to a full GP to increase computational
efficiency. First, for each likelihood evaluation, we evaluate a full GP on a regular grid between
0.1 M⊙ and 250 M⊙ and then interpolate it at each data point. Second, we use the quasi-separability
of Mat´ern kernels to analytically perform the transformation between covariance matrix and GP draw.
This second step is done using the QuasisepSolver module (Foreman-Mackey et al. 2017) in the
tinygp code base (Foreman-Mackey 2021), and requires data to be sortable (i.e. one-dimensional).
§ Algorithmically, each posterior evaluation contains the following steps:
1. Draw cosmological parameters H0 and ΩM from uniform prior distributions.
2. Convert the luminosity distances and detector-frame masses of each event posterior sample to
redshifts and source-frame masses according to the cosmology specified by step 1.
3. Draw hyper-hyper-parameters l and s from the penalized-complexity priors described above.
21
4. Draw a single GP realization with a kernel defined by l and s. This is defined on a regular grid
of source-frame masses and evaluated using the QuasisepSolver in tinygp.
5. Interpolate the GP at each event posterior sample and injection source-frame mass (from step
3).
6. Calculate the population likelihood according to Equation 1.
We perform these steps within numpyro (Bingham et al. 2019; Phan et al. 2019), sampling the
posterior using the no-u-turn sampler for Hamiltonian Monte Carlo (Hoffman & Gelman 2011). This
§ can be seen explicitly in the source code accompanying this paper, in the scripts/priors.py
script.
D. BIASES INDUCED BY THE Broken Power Law MODEL
Figure 5 shows recovered posteriors on H0 as inferred from 50 mock catalogs using both the Broken
Power Law and Power Law + Peak parametric models. We find that the Power Law + Peak
model recovers H0 posteriors that are largely symmetric about the true value, whereas the Broken
Power Law model typically finds more support for larger H0 values. We note that (Pierra et al.
2023) report an underestimate of H0 when fitting their Broken Power Law model to a single dataset
generated with Power Law + Peak, but the prior bounds on the maximum mass parameter of
their model do not extend below the injected value of that parameter, which in turn does not allow for
the possibility of an overestimated H0. It is therefore not possible to directly compare the direction
of our observed H0 offset with theirs, despite the similarities bewteen our chosen population models.
Regardless, this systematic offset demonstrates that incorrect parametric models unfortunately
induce a systematic bias in cosmological inference, not an increase in statistical uncertainty. Other
parametric models may show different trends depending on which parts of the mass distribution they
incorrectly model and how. Therefore, while we are able to identify the shortcomings of Broken
Power Law when Power Law + Peak describes the true mass distribution, it is not possible in
practice to know which direction an incorrect parametric model will bias H0. Mitigating the bias by
using more flexible models may thus be the simplest solution to this problem.
22
40 60 80 100
H0 [km/s/Mpc]
0.00
0.02
0.04
0.06
0.08
0.10
0.12
posterior density
Power Law + Peak
Broken Power Law
Figure 5. Recovered posteriors on H0 from spectral siren analyses on 50 mock catalogs with the Power
Law + Peak (green) and Broken Power Law (pink) parametric models. The true, injected value is
shown by a vertical black line. §