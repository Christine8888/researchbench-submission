{
    "task_id": "mass_gap_constraint",
    "paper_id": "gw_nsbh",
    "kind": "numeric",
    "difficulty": 6,
    "description": "Estimate the 1-sigma uncertainty (one-sided error) on the mass gap width measurement from simulated observations of 50 and 150 NSBH events.",
    "instructions": "1. Define the fiducial ('true') astrophysical population model parameters as follows:\n    - Maximum non-spinning NS mass: $M_\\text{TOV} = 2.0 \\, M_\\odot$.\n    - Minimum BH mass: $M_\\text{BH} = 5.0 \\, M_\\odot$.\n    - BH mass power-law slope: $\\alpha = 2.0$.\n    - Pairing function power-law index: $\\beta = 3.0$.\n    - NS mass model: Use the 'Default' single truncated Gaussian model (Section II.A.2). Set fiducial parameters $\\mu = 1.5 \\, M_\\odot$ and $\\sigma = 0.5 \\, M_\\odot$. Truncate at $M_\\mathrm{min}=1\\,M_\\odot$ and the spin-dependent maximum mass $M_\\mathrm{max}(a_2)$ calculated using the universal relation with $M_\\text{TOV}=2.0\\,M_\\odot$ and $a_\\mathrm{Kep}=0.7$.\n    - Spin model: Use the 'ZS + AS' model (Section II.A.1): Primary BH nonspinning ($a_1 = 0$), secondary NS spin aligned ($\\cos(\\mathrm{tilt}_2)=1$). Assume a 'uniform' NS spin magnitude distribution: $p(a_2) \\propto 1$ for $0 < a_2 < a_\\mathrm{max}$, with $a_\\mathrm{max}/a_\\mathrm{Kep} = 1.0$ ($\\beta_s = 0, a_\\mathrm{Kep}=0.7$).\n2. Simulate two catalogs of detected NSBH events assuming LIGO A+ sensitivity (Section IV.A), one with $N_\\mathrm{det} = 50$ events and one with $N_\\mathrm{det} = 150$ events.\n    - For each event in the catalogs:\n        a. Draw true parameters ($m_1, m_2, a_1, a_2$) from the fiducial population model defined in step 1. Ensure $a_1=0$ and $a_{2,z}=a_2$.\n        b. Calculate the detection probability $P_\\mathrm{det}$ assuming A+ sensitivity and SNR threshold $\\rho_\\mathrm{thresh}=8$ (as per Section II.B.2). Keep only detected events until the target number ($N_\\mathrm{det}=50$ or $N_\\mathrm{det}=150$) is reached.\n        c. For each detected event, simulate mock parameter estimation posterior samples ($m_1, m_2, a_{1,z}, a_{2,z}$) using the Post-Newtonian approximation method described in Section II.C.2. Use the event's calculated SNR $\\rho$ (from step 2b) to determine the PN coefficient uncertainties $\\sigma_0 = 0.0046\\psi_0/\\rho$, $\\sigma_2 = 0.2341\\psi_2/\\rho$, and $\\sigma_3 = -0.1293\\psi_3/\\rho$.\n3. For each simulated catalog (N=50 and N=150):\n    a. Perform hierarchical Bayesian inference using the framework from Section II.B, fitting the same population model structure used for generating the data (1-component Gaussian NS mass, power-law BH mass, ZS+AS spin model inferring $\\beta_s$ and $a_\\mathrm{max}/a_\\mathrm{Kep}$, $\\beta=3$ pairing, universal relation for $M_\\mathrm{max}(a_2)$). Use priors from Table I. Include selection effects for A+ sensitivity.\n    b. From the resulting posterior samples for the hyperparameters, calculate the posterior distribution for the mass gap width, defined as $M_\\mathrm{BH} - M_\\mathrm{TOV}$.\n    c. Determine the 68% credible interval for the mass gap width (16th to 84th percentiles).\n    d. Calculate the symmetric one-sided error as (84th percentile - 16th percentile) / 2.\n4. Return the calculated one-sided errors for the 50-event and 150-event simulations as a list in the format [error_on_50_events, error_on_150_events].",
    "tolerance": [
        0.02,
        0.02
    ],
    "expected_output": [
        0.08,
        0.05
    ],
    "parents": [
        "default_mtov",
        "load_data"
    ],
    "output_justification": "The expected output values are the 1-sigma symmetric one-sided errors on the mass gap width reported in Section IV.C for the simulated case with a wide mass gap ($M_\\text{TOV} = 2\\,M_\\odot$, $M_\\text{BH} = 5\\,M_\\odot$). The paper states that '50 NSBH events can measure the mass gap width to $3.00 \\pm 0.08 M_\\odot$, and $\\pm 0.05 M_\\odot$ can be achieved with 150 events'. The $\\pm$ values represent the one-sided errors."
}